

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Dask DataFrame &#8212; Dask Tutorial</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/02-dask-dataframe';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Parallelizing Xarray with Dask" href="03-dask-xarray.html" />
    <link rel="prev" title="Dask Arrays" href="01-dask-array.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../README.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/NCAR_CISL_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/NCAR_CISL_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../README.html">
                    NCAR Dask Tutorial
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introductions to Dask</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00-dask-overview.html">Dask Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-dask-array.html">Dask Arrays</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Dask DataFrame</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dask and Xarray</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="03-dask-xarray.html">Parallelizing Xarray with Dask</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dask on HPC</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="04-dask-cluster.html">Dask Schedulers</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-dask-hpc.html">Dask on HPC - Starting Clusters, Monitoring, and Debugging</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Dask Best Practices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="06-dask-chunking.html">Dask Chunking - Best Practices</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/NCAR/dask-tutorial/main?urlpath=lab/tree/notebooks/02-dask-dataframe.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://jupyterhub.hpc.ucar.edu/stable/hub/user-redirect/git-pull?repo=https%3A//github.com/NCAR/dask-tutorial&urlpath=lab/tree/dask-tutorial/notebooks/02-dask-dataframe.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NCAR/dask-tutorial" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NCAR/dask-tutorial/edit/main/notebooks/02-dask-dataframe.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NCAR/dask-tutorial/issues/new?title=Issue%20on%20page%20%2Fnotebooks/02-dask-dataframe.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/02-dask-dataframe.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Dask DataFrame</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-tutorial-you-learn">In this tutorial, you learn:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#related-documentation">Related Documentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-dask-dataframe">What is Dask DataFrame?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-dask-dataframe-and-when-to-avoid-it">When to use Dask DataFrame and when to avoid it?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-dataset">Tutorial Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-data">Download the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframe-basics">Pandas DataFrame Basics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operations-on-pandas-dataframe">Operations on pandas DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-analysis">Simple Analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-up-to-a-larger-dataset">Scaling up to a larger dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computations-on-dask-dataframe">Computations on Dask DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-localcluster-client-with-dask">Create a “LocalCluster” Client with Dask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dask-dataframe-read-csv-to-read-multiple-files">Dask DataFrame <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> to read multiple files</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lazy-evaluation">Lazy Evaluation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nice-but-what-did-dask-do">Nice, but what did Dask do?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-compute-wisely">Use <code class="docutils literal notranslate"><span class="pre">.compute</span></code> wisely!</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#share-intermediate-results">Share intermediate results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#persist-or-caching"><code class="docutils literal notranslate"><span class="pre">.persist</span></code> or caching</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dask-dataframes-best-practices">Dask DataFrames Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-pandas-when-you-can">Use pandas (when you can)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-full-data-shuffling">Avoid Full-Data Shuffling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-performance-tips">pandas performance tips</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-partition-size">Check Partition Size</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#blocksize"><code class="docutils literal notranslate"><span class="pre">blocksize</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-use-of-compute">Smart use of <code class="docutils literal notranslate"><span class="pre">.compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#close-your-local-dask-cluster">Close your local Dask Cluster</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <p><img src="https://raw.githubusercontent.com/NCAR/dask-tutorial/main/images/NCAR-contemp-logo-blue.png"
     width="750px"
     alt="NCAR logo"
     style="vertical-align:middle;margin:30px 0px"/></p>
<section class="tex2jax_ignore mathjax_ignore" id="dask-dataframe">
<h1>Dask DataFrame<a class="headerlink" href="#dask-dataframe" title="Permalink to this heading">#</a></h1>
<p><strong>ESDS dask tutorial | 06 February, 2023</strong></p>
<p>Negin Sobhani, Brian Vanderwende, Deepak Cherian, Ben Kirk<br />
Computational &amp; Information Systems Lab (CISL)<br />
<a class="reference external" href="mailto:negins&#37;&#52;&#48;ucar&#46;edu">negins<span>&#64;</span>ucar<span>&#46;</span>edu</a>, <a class="reference external" href="mailto:vanderwb&#37;&#52;&#48;ucar&#46;edu">vanderwb<span>&#64;</span>ucar<span>&#46;</span>edu</a></p>
<hr class="docutils" />
<section id="in-this-tutorial-you-learn">
<h2>In this tutorial, you learn:<a class="headerlink" href="#in-this-tutorial-you-learn" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Basic concepts and features of Dask DataFrames</p></li>
<li><p>Applications of Dask DataFrames</p></li>
<li><p>Interacting with Dask DataFrames</p></li>
<li><p>Built-in operations with Dask DataFrames</p></li>
<li><p>Dask DataFrames Best Practices</p></li>
</ul>
</section>
<section id="related-documentation">
<h2>Related Documentation<a class="headerlink" href="#related-documentation" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.dask.org/en/latest/dataframe.html">Dask DataFrame documentation</a></p></li>
<li><p><a class="reference external" href="https://docs.dask.org/en/latest/dataframe-api.html">Dask DataFrame API</a></p></li>
<li><p><a class="reference external" href="https://examples.dask.org/dataframe.html">Dask DataFrame examples</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/">pandas documentation</a></p></li>
</ul>
</section>
<hr class="docutils" />
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading">#</a></h2>
<p><img src="https://raw.githubusercontent.com/NCAR/dask-tutorial/main/images/dask_dataframe.png"
     align="right"
     width="530px"
     alt="Dask DataFrame is composed of pandas DataFrames"/></p>
<p>pandas is a very popular tool for working with <strong>tabular datasets</strong>, but the dataset needs to <strong>fit into the memory</strong>.</p>
<p>pandas operates best with smaller datasets, and if you have a large dataset, you’ll receive an out of memory error using pandas. A general rule of thumb for pandas is:</p>
<blockquote>
<div><p>“Have 5 to 10 times as much RAM as the size of your dataset”</p>
<p>~ Wes McKinney (2017) in <a class="reference external" href="https://wesmckinney.com/blog/apache-arrow-pandas-internals/">10 things I hate about pandas</a></p>
</div></blockquote>
<p>But Dask DataFrame can be used to solve pandas performance issues with larger-than-memory datasets.</p>
<section id="what-is-dask-dataframe">
<h3>What is Dask DataFrame?<a class="headerlink" href="#what-is-dask-dataframe" title="Permalink to this heading">#</a></h3>
<ul>
<li><p><strong>A Dask DataFrame is a parallel DataFrame composed of smaller pandas DataFrames (also known as <em>partitions</em>).</strong></p></li>
<li><p>Dask Dataframes look and feel like the pandas DataFrames on the surface.</p></li>
<li><p>Dask DataFrames partition the data into manageable <strong>partitions</strong> that can be processed in parallel and across multiple cores or computers.</p></li>
<li><p>Similar to Dask Arrays, Dask DataFrames are lazy!</p>
<p>Unlike pandas, operations on Dask DataFrames are not computed until you explicitly request them (e.g. by calling <code class="docutils literal notranslate"><span class="pre">.compute</span></code>).</p>
</li>
</ul>
</section>
</section>
<section id="when-to-use-dask-dataframe-and-when-to-avoid-it">
<h2>When to use Dask DataFrame and when to avoid it?<a class="headerlink" href="#when-to-use-dask-dataframe-and-when-to-avoid-it" title="Permalink to this heading">#</a></h2>
<p>Dask DataFrames are used in situations where pandas <em>fails</em> or has <em>poor performance due to data size</em>.</p>
<p>Dask DataFrame is a good choice when doing <strong>parallalizeable computations</strong>.<br />
Some examples are:</p>
<ul class="simple">
<li><p>Element-wise operations such as <code class="docutils literal notranslate"><span class="pre">df.x</span> <span class="pre">+</span> <span class="pre">df.y</span></code></p></li>
<li><p>Row-wise filtering such as <code class="docutils literal notranslate"><span class="pre">df[df.x&gt;0]</span></code></p></li>
<li><p>Common aggregations such as <code class="docutils literal notranslate"><span class="pre">df.x.max()</span></code></p></li>
<li><p>Dropping duplicates such as <code class="docutils literal notranslate"><span class="pre">df.x.drop_duplicate()</span></code></p></li>
</ul>
<p>However, Dask is not great for operations that requires shuffling or re-indexing.<br />
Some examples are:</p>
<ul class="simple">
<li><p>Set index: <code class="docutils literal notranslate"><span class="pre">df.set_index(df.x)</span></code></p></li>
</ul>
<div class="alert alert-block alert-warning" markdown="1">
<b>WARNING:</b> Although, Dask DataFrame has a very similar interface to the pandas DataFrame (as we will see in this tutorial), it does NOT include some of the pandas interface yet.
<p>See the <a class="reference external" href="https://docs.dask.org/en/stable/dataframe-api.html">Dask DataFrame API documentation</a> for a compehnsive list of available functions.</p>
</div>
</section>
<hr class="docutils" />
<section id="tutorial-dataset">
<h2>Tutorial Dataset<a class="headerlink" href="#tutorial-dataset" title="Permalink to this heading">#</a></h2>
<p>In this tutorial, we are going to use the NOAA Global Historical Climatology Network Daily (GHCN-D) dataset.<br />
GHCN-D is a public available dataset that includes daily climate records from +100,000 surface observations around the world.<br />
This is an example of a real dataset that is used by NCAR scientists for their research. GHCN-D raw dataset for all stations is available through <a class="reference external" href="https://www.ncdc.noaa.gov/cdo-web/search?datasetid=GHCND">NOAA Climate Data Online</a>.</p>
<p><strong>To learn more about GHCNd dataset, please visit:</strong></p>
<ul class="simple">
<li><p><a class="reference external" href="https://journals.ametsoc.org/view/journals/atot/29/7/jtech-d-11-00103_1.xml">GHCNd Journal Paper</a></p></li>
<li><p><a class="reference external" href="https://www.ncei.noaa.gov/products/land-based-station/global-historical-climatology-network-daily">GHCNd Official Website</a></p></li>
</ul>
<section id="download-the-data">
<h3>Download the data<a class="headerlink" href="#download-the-data" title="Permalink to this heading">#</a></h3>
<p>For this example, we are going to look through a subset of data from the GHCN-D dataset.</p>
<p>First, we look at the daily observations from Denver International Airport, next we are going to look through selected stations in the US.</p>
<p>The access the preprocessed dataset for this tutorial, please run the following script:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>./get_data.sh
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--2023-02-05 13:50:53--  https://docs.google.com/uc?export=download&amp;id=14doSRn8hT14QYtjZz28GKv14JgdIsbFF
Resolving docs.google.com... 142.250.72.78, 2607:f8b0:400f:807::200e
Connecting to docs.google.com|142.250.72.78|:443... connected.
HTTP request sent, awaiting response... 303 See Other
Location: https://doc-08-74-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/hkbhr7uhov17jj84626eu6oouerldgvu/1675630200000/12706685253353286515/*/14doSRn8hT14QYtjZz28GKv14JgdIsbFF?e=download&amp;uuid=8c5eb41b-5044-4497-8562-d31dc9d3bc4d [following]
Warning: wildcards not supported in HTTP.
--2023-02-05 13:51:05--  https://doc-08-74-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/hkbhr7uhov17jj84626eu6oouerldgvu/1675630200000/12706685253353286515/*/14doSRn8hT14QYtjZz28GKv14JgdIsbFF?e=download&amp;uuid=8c5eb41b-5044-4497-8562-d31dc9d3bc4d
Resolving doc-08-74-docs.googleusercontent.com... 142.250.72.33, 2607:f8b0:400f:804::2001
Connecting to doc-08-74-docs.googleusercontent.com|142.250.72.33|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 19013376 (18M) [application/x-tar]
Saving to: ‘../data.tar.gz’

../data.tar.gz      100%[===================&gt;]  18.13M  52.5MB/s    in 0.3s    

2023-02-05 13:51:05 (52.5 MB/s) - ‘../data.tar.gz’ saved [19013376/19013376]

USC00023160.csv
USC00027281.csv
USC00027390.csv
USC00030936.csv
USC00031596.csv
USC00032444.csv
USC00035186.csv
USC00035754.csv
USC00035820.csv
USC00035908.csv
USC00042294.csv
USC00044259.csv
USC00048758.csv
USC00050848.csv
USC00051294.csv
USC00051528.csv
USC00051564.csv
USC00051741.csv
USC00052184.csv
USC00052281.csv
USC00052446.csv
USC00053005.csv
USC00053038.csv
USC00053146.csv
USC00053662.csv
USC00053951.csv
USC00054076.csv
USC00054770.csv
USC00054834.csv
USC00055322.csv
USC00055722.csv
USC00057167.csv
USC00057337.csv
--2023-02-05 13:51:07--  https://docs.google.com/uc?export=download&amp;id=15rCwQUxxpH6angDhpXzlvbe1nGetYHrf
Resolving docs.google.com... 142.250.72.78, 2607:f8b0:400f:807::200e
Connecting to docs.google.com|142.250.72.78|:443... connected.
HTTP request sent, awaiting response... 303 See Other
Location: https://doc-0o-74-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/9f30ek7ivt0gum0c34hgalhsikads9th/1675630275000/12706685253353286515/*/15rCwQUxxpH6angDhpXzlvbe1nGetYHrf?e=download&amp;uuid=deb6d161-3a18-444b-b54a-a6ee1280cba9 [following]
Warning: wildcards not supported in HTTP.
--2023-02-05 13:51:15--  https://doc-0o-74-docs.googleusercontent.com/docs/securesc/ha0ro937gcuc7l7deffksulhg5h7mbp1/9f30ek7ivt0gum0c34hgalhsikads9th/1675630275000/12706685253353286515/*/15rCwQUxxpH6angDhpXzlvbe1nGetYHrf?e=download&amp;uuid=deb6d161-3a18-444b-b54a-a6ee1280cba9
Resolving doc-0o-74-docs.googleusercontent.com... 142.250.72.33, 2607:f8b0:400f:804::2001
Connecting to doc-0o-74-docs.googleusercontent.com|142.250.72.33|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 20132755 (19M) [application/x-tar]
Saving to: ‘../data.tar.gz’

../data.tar.gz      100%[===================&gt;]  19.20M  67.9MB/s    in 0.3s    

2023-02-05 13:51:16 (67.9 MB/s) - ‘../data.tar.gz’ saved [20132755/20132755]

USC00057936.csv
USC00058204.csv
USC00058429.csv
USC00059243.csv
USC00068138.csv
USC00080211.csv
USC00084731.csv
USC00088824.csv
USC00098703.csv
USC00100010.csv
USC00100470.csv
USC00105275.csv
USC00106152.csv
USC00107264.csv
USC00108137.csv
USC00110338.csv
USC00112140.csv
USC00112193.csv
USC00112348.csv
USC00112483.csv
USC00113335.csv
USC00114108.csv
USC00114442.csv
USC00114823.csv
USC00115079.csv
USC00115326.csv
USC00115712.csv
USC00115768.csv
USC00115833.csv
USC00115901.csv
USC00115943.csv
USC00116446.csv
USW00003017.csv
</pre></div>
</div>
</div>
</div>
<p>This script should save the preprocessed GHCN-D data in <code class="docutils literal notranslate"><span class="pre">../data</span></code> path.</p>
</section>
</section>
<hr class="docutils" />
<section id="pandas-dataframe-basics">
<h2>Pandas DataFrame Basics<a class="headerlink" href="#pandas-dataframe-basics" title="Permalink to this heading">#</a></h2>
<p>Let’s start with an example using pandas DataFrame.</p>
<p>First, let’s read in the comma-seperated GHCN-D dataset for one station at <strong>Denver International Airport (DIA), CO</strong> (site ID : <code class="docutils literal notranslate"><span class="pre">USW00003017</span></code>).</p>
<p>To see the list of all available GHCN-D sites and their coordinates and IDs, please see <a class="reference external" href="https://www.ncei.noaa.gov/pub/data/ghcn/daily/ghcnd-stations.txt">this link</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># DIA ghcnd id</span>
<span class="n">site</span> <span class="o">=</span> <span class="s1">&#39;USW00003017&#39;</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;../data/&#39;</span>


<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="n">site</span><span class="o">+</span><span class="s1">&#39;.csv&#39;</span><span class="p">),</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">],</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display the top five rows of the dataframe</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ID</th>
      <th>YEAR</th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>TMAX</th>
      <th>TMAX_FLAGS</th>
      <th>TMIN</th>
      <th>TMIN_FLAGS</th>
      <th>PRCP</th>
      <th>PRCP_FLAGS</th>
      <th>...</th>
      <th>RHMN_FLAGS</th>
      <th>RHMX</th>
      <th>RHMX_FLAGS</th>
      <th>PSUN</th>
      <th>PSUN_FLAGS</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>ELEVATION</th>
      <th>STATE</th>
      <th>STATION</th>
    </tr>
    <tr>
      <th>DATE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1994-07-20</th>
      <td>USW00003017</td>
      <td>1994</td>
      <td>7</td>
      <td>20</td>
      <td>316.0</td>
      <td>XXS</td>
      <td>150.0</td>
      <td>XXS</td>
      <td>20.0</td>
      <td>DXS</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>39.8467</td>
      <td>-104.6561</td>
      <td>1647.1</td>
      <td>CO</td>
      <td>DENVER INTL AP</td>
    </tr>
    <tr>
      <th>1994-07-23</th>
      <td>USW00003017</td>
      <td>1994</td>
      <td>7</td>
      <td>23</td>
      <td>355.0</td>
      <td>XXS</td>
      <td>166.0</td>
      <td>XXS</td>
      <td>0.0</td>
      <td>DXS</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>39.8467</td>
      <td>-104.6561</td>
      <td>1647.1</td>
      <td>CO</td>
      <td>DENVER INTL AP</td>
    </tr>
    <tr>
      <th>1994-07-24</th>
      <td>USW00003017</td>
      <td>1994</td>
      <td>7</td>
      <td>24</td>
      <td>333.0</td>
      <td>XXS</td>
      <td>155.0</td>
      <td>XXS</td>
      <td>81.0</td>
      <td>DXS</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>39.8467</td>
      <td>-104.6561</td>
      <td>1647.1</td>
      <td>CO</td>
      <td>DENVER INTL AP</td>
    </tr>
    <tr>
      <th>1994-07-25</th>
      <td>USW00003017</td>
      <td>1994</td>
      <td>7</td>
      <td>25</td>
      <td>327.0</td>
      <td>XXS</td>
      <td>172.0</td>
      <td>XXS</td>
      <td>0.0</td>
      <td>DXS</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>39.8467</td>
      <td>-104.6561</td>
      <td>1647.1</td>
      <td>CO</td>
      <td>DENVER INTL AP</td>
    </tr>
    <tr>
      <th>1994-07-26</th>
      <td>USW00003017</td>
      <td>1994</td>
      <td>7</td>
      <td>26</td>
      <td>327.0</td>
      <td>XXS</td>
      <td>155.0</td>
      <td>XXS</td>
      <td>0.0</td>
      <td>DXS</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>39.8467</td>
      <td>-104.6561</td>
      <td>1647.1</td>
      <td>CO</td>
      <td>DENVER INTL AP</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 99 columns</p>
</div></div></div>
</div>
<p><strong>Question:</strong> What variables are available?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;ID&#39;, &#39;YEAR&#39;, &#39;MONTH&#39;, &#39;DAY&#39;, &#39;TMAX&#39;, &#39;TMAX_FLAGS&#39;, &#39;TMIN&#39;,
       &#39;TMIN_FLAGS&#39;, &#39;PRCP&#39;, &#39;PRCP_FLAGS&#39;, &#39;TAVG&#39;, &#39;TAVG_FLAGS&#39;, &#39;SNOW&#39;,
       &#39;SNOW_FLAGS&#39;, &#39;SNWD&#39;, &#39;SNWD_FLAGS&#39;, &#39;AWND&#39;, &#39;AWND_FLAGS&#39;, &#39;FMTM&#39;,
       &#39;FMTM_FLAGS&#39;, &#39;PGTM&#39;, &#39;PGTM_FLAGS&#39;, &#39;WDF2&#39;, &#39;WDF2_FLAGS&#39;, &#39;WDF5&#39;,
       &#39;WDF5_FLAGS&#39;, &#39;WSF2&#39;, &#39;WSF2_FLAGS&#39;, &#39;WSF5&#39;, &#39;WSF5_FLAGS&#39;, &#39;WT01&#39;,
       &#39;WT01_FLAGS&#39;, &#39;WT02&#39;, &#39;WT02_FLAGS&#39;, &#39;WT08&#39;, &#39;WT08_FLAGS&#39;, &#39;WT16&#39;,
       &#39;WT16_FLAGS&#39;, &#39;WT17&#39;, &#39;WT17_FLAGS&#39;, &#39;WT18&#39;, &#39;WT18_FLAGS&#39;, &#39;WT03&#39;,
       &#39;WT03_FLAGS&#39;, &#39;WT05&#39;, &#39;WT05_FLAGS&#39;, &#39;WT19&#39;, &#39;WT19_FLAGS&#39;, &#39;WT10&#39;,
       &#39;WT10_FLAGS&#39;, &#39;WT09&#39;, &#39;WT09_FLAGS&#39;, &#39;WT06&#39;, &#39;WT06_FLAGS&#39;, &#39;WT07&#39;,
       &#39;WT07_FLAGS&#39;, &#39;WT11&#39;, &#39;WT11_FLAGS&#39;, &#39;WT13&#39;, &#39;WT13_FLAGS&#39;, &#39;WT21&#39;,
       &#39;WT21_FLAGS&#39;, &#39;WT14&#39;, &#39;WT14_FLAGS&#39;, &#39;WT15&#39;, &#39;WT15_FLAGS&#39;, &#39;WT22&#39;,
       &#39;WT22_FLAGS&#39;, &#39;WT04&#39;, &#39;WT04_FLAGS&#39;, &#39;WV03&#39;, &#39;WV03_FLAGS&#39;, &#39;TSUN&#39;,
       &#39;TSUN_FLAGS&#39;, &#39;WV01&#39;, &#39;WV01_FLAGS&#39;, &#39;WESD&#39;, &#39;WESD_FLAGS&#39;, &#39;ADPT&#39;,
       &#39;ADPT_FLAGS&#39;, &#39;ASLP&#39;, &#39;ASLP_FLAGS&#39;, &#39;ASTP&#39;, &#39;ASTP_FLAGS&#39;, &#39;AWBT&#39;,
       &#39;AWBT_FLAGS&#39;, &#39;RHAV&#39;, &#39;RHAV_FLAGS&#39;, &#39;RHMN&#39;, &#39;RHMN_FLAGS&#39;, &#39;RHMX&#39;,
       &#39;RHMX_FLAGS&#39;, &#39;PSUN&#39;, &#39;PSUN_FLAGS&#39;, &#39;LATITUDE&#39;, &#39;LONGITUDE&#39;,
       &#39;ELEVATION&#39;, &#39;STATE&#39;, &#39;STATION&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>The description and units of the dataset is available <a class="reference external" href="https://www.ncei.noaa.gov/pub/data/ghcn/daily/readme.txt">here</a>.</p>
<section id="operations-on-pandas-dataframe">
<h3>Operations on pandas DataFrame<a class="headerlink" href="#operations-on-pandas-dataframe" title="Permalink to this heading">#</a></h3>
<p>pandas DataFrames has several features that give us flexibility to do different calculations and analysis on our dataset. Let’s check some out:</p>
<section id="simple-analysis">
<h4>Simple Analysis<a class="headerlink" href="#simple-analysis" title="Permalink to this heading">#</a></h4>
<p>For example:</p>
<ul class="simple">
<li><p>When was the coldest day at this station during December of last year?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use python slicing notation inside .loc </span>
<span class="c1"># use idxmin() to find the index of minimum valus</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2022-12-01&#39;</span><span class="p">:</span><span class="s1">&#39;2022-12-31&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">TMIN</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Timestamp(&#39;2022-12-22 00:00:00&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Here we easily plot the prior data using matplotlib from pandas</span>
<span class="c1"># -- .loc for value based indexing</span>
<span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2022-12-01&#39;</span><span class="p">:</span><span class="s1">&#39;2022-12-31&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">SNWD</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ylabel</span><span class="o">=</span> <span class="s1">&#39;Daily Average Snow Depth [mm]&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;DATE&#39;, ylabel=&#39;Daily Average Snow Depth [mm]&#39;&gt;
</pre></div>
</div>
<img alt="../_images/7751b18eadfefaf0b61c2cf07efcc485f2ca51c67f0b3a7c437bbdc7c51ece72.png" src="../_images/7751b18eadfefaf0b61c2cf07efcc485f2ca51c67f0b3a7c437bbdc7c51ece72.png" />
</div>
</div>
<ul class="simple">
<li><p>How many snow days do we have each year at this station?</p></li>
</ul>
<p>Pandas groupby is used for grouping the data according to the categories.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1- First select days with snow &gt; 0</span>
<span class="c1"># 2- Create a &quot;groupby object&quot; based on the selected columns</span>
<span class="c1"># 3- use .size() to compute the size of each group</span>
<span class="c1"># 4- sort the values descending </span>

<span class="c1"># we count days where SNOW&gt;0, and sort them and show top 5 years:</span>
<span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SNOW&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;YEAR&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>YEAR
2015    36
2019    34
2014    32
2008    32
2007    31
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Or for a more complex analysis:</p>
<p>For example, we have heard that this could be Denver’s first January in 13 years with no 60-degree days.</p>
<p><img src="https://raw.githubusercontent.com/NCAR/dask-tutorial/main/images/denver2.png"
     alt="Dask DataFrame is composed of pandas DataFrames"/></p>
<p>Below, we show all days with high temperature above 60°F (155.5°C/10) since 2010:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;TMAX&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">155.5</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;YEAR&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>YEAR
2011    1
2012    6
2013    4
2014    3
2015    6
2016    1
2017    4
2018    5
2019    3
2020    2
2021    2
2022    3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>This is great! But how big is this dataset for one station?</p>
<p>First, let’s check the file size:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls<span class="w"> </span>-lh<span class="w"> </span>../data/USW00003017.csv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-rw-r--r-- 1 negins ncar 3.6M Feb  5 07:14 ../data/USW00003017.csv
</pre></div>
</div>
</div>
</div>
<p>Similar to the previous tutorial, we can use the following function to find the size of a variable on memory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define function to display variable size in MB</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">def</span> <span class="nf">var_size</span><span class="p">(</span><span class="n">in_var</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">in_var</span><span class="p">)</span> <span class="o">/</span> <span class="mf">1e6</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Size of variable: </span><span class="si">{</span><span class="n">result</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MB&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_size</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Size of variable: 33.21 MB
</pre></div>
</div>
</div>
</div>
<p>Remember, the above rule?</p>
<blockquote>
<div><p>“Have 5 to 10 times as much RAM as the size of your dataset”</p>
<p>~ Wes McKinney (2017) in <a class="reference external" href="https://wesmckinney.com/blog/apache-arrow-pandas-internals/">10 things I hate about pandas</a></p>
</div></blockquote>
<p><strong>So far, we read in and analyzed data for one station. We have a total of +118,000 stations over the world and +4500 stations in Colorado alone!</strong></p>
<p><strong>What if we want to look at the larger dataset?</strong></p>
</section>
</section>
</section>
<section id="scaling-up-to-a-larger-dataset">
<h2>Scaling up to a larger dataset<a class="headerlink" href="#scaling-up-to-a-larger-dataset" title="Permalink to this heading">#</a></h2>
<p>Let’s start by reading data from selected stations. The downloaded data for this example includes the climatology observations from 66 selected sites in Colorado.</p>
<p>Pandas can concatenate data to load data spread across multiple files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>du<span class="w"> </span>-csh<span class="w"> </span>../data/*.csv<span class="w"> </span><span class="p">|</span>tail<span class="w"> </span>-n1
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>566M	total
</pre></div>
</div>
</div>
</div>
<p>Using a for loop with <code class="docutils literal notranslate"><span class="pre">pandas.concat</span></code>, we can read multiple files at the same time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="n">co_sites</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s1">&#39;*.csv&#39;</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">co_sites</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 11.9 s, sys: 2.87 s, total: 14.8 s
Wall time: 19.5 s
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>How many stations have we read in?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Concatenated data for&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">ID</span><span class="o">.</span><span class="n">unique</span><span class="p">()),</span> <span class="s2">&quot;unique sites.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Concatenated data for 66 unique sites.
</pre></div>
</div>
</div>
</div>
<p>Now that we concatenated the data for all sites in one DataFrame, we can do similar analysis on it:</p>
<ul class="simple">
<li><p>Which site has recorded the most snow days in a year?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># ~90s on 4GB RAM</span>
<span class="n">snowy_days</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;SNOW&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;YEAR&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>

<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;This site has the highest number of snow days in a year : &#39;</span><span class="p">)</span>
<span class="n">snowy_days</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;idxmax&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This site has the highest number of snow days in a year : 
CPU times: user 4.49 s, sys: 15.4 s, total: 19.9 s
Wall time: 1min 21s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>idxmax    (USC00052281, 1983)
max                       102
dtype: object
</pre></div>
</div>
</div>
</div>
<p><strong>Excersise:</strong> Which Colorado site has recorded the most snow days in 2023?</p>
<p><strong>Dask allows us to conceptualize all of these files as a single dataframe!</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s do a little cleanup</span>
<span class="k">del</span> <span class="n">df</span><span class="p">,</span> <span class="n">snowy_days</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="computations-on-dask-dataframe">
<h2>Computations on Dask DataFrame<a class="headerlink" href="#computations-on-dask-dataframe" title="Permalink to this heading">#</a></h2>
<section id="create-a-localcluster-client-with-dask">
<h3>Create a “LocalCluster” Client with Dask<a class="headerlink" href="#create-a-localcluster-client-with-dask" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span><span class="p">,</span> <span class="n">LocalCluster</span>

<span class="n">cluster</span> <span class="o">=</span> <span class="n">LocalCluster</span><span class="p">()</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="n">cluster</span><span class="p">)</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-53ec3d8d-a599-11ed-bb54-3cecef1b11d4</p>
        <table style="width: 100%; text-align: left;">

        <tr>
        
            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>
        
        </tr>

        
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/8787/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>
        

        </table>

        
            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">2ddb751e</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/8787/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 4
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 4
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 4.00 GiB
                </td>
            </tr>
            
            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>

            
        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-7ff96b2c-e98a-4ea8-9644-554701393a83</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:38113
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 4
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/8787/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 4
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 4.00 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>

        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:35345
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/40352/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/40352/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 1.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:44090
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /glade/scratch/negins/dask-worker-space/worker-5nmxv_zk
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:39634
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/46672/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/46672/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 1.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:39719
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /glade/scratch/negins/dask-worker-space/worker-f5__nvpk
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:37524
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/33848/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/33848/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 1.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:37649
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /glade/scratch/negins/dask-worker-space/worker-a517utir
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:46848
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/36957/status" target="_blank">https://jupyterhub.hpc.ucar.edu/stable/user/negins/proxy/36957/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 1.00 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:40787
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /glade/scratch/negins/dask-worker-space/worker-mboofx4v
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        

    </details>
</div>

        </details>
    </div>
</div>
            </details>
        

    </div>
</div></div></div>
</div>
<p>☝️ Click the Dashboard link above.</p>
<p>👈 Or click the “Search” 🔍 button in the dask-labextension dashboard.</p>
</section>
<section id="dask-dataframe-read-csv-to-read-multiple-files">
<h3>Dask DataFrame <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> to read multiple files<a class="headerlink" href="#dask-dataframe-read-csv-to-read-multiple-files" title="Permalink to this heading">#</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">dask.dataframe.read_csv</span></code> function can be used in conjunction with <code class="docutils literal notranslate"><span class="pre">glob</span></code> to read multiple csv files at the same time.</p>
<p>Remember we can read one file with <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code>. For reading multiple files with pandas, we have to concatenate them with <code class="docutils literal notranslate"><span class="pre">pd.concatenate</span></code>. However, we can read many files at once just using <code class="docutils literal notranslate"><span class="pre">dask.dataframe.read_csv</span></code>.</p>
<p>Overall, Dask is designed to perform I/O in parallel and is more performant than pandas for operations with multiple files or large files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">import</span> <span class="nn">dask.dataframe</span> <span class="k">as</span> <span class="nn">dd</span>

<span class="n">ddf</span> <span class="o">=</span> <span class="n">dd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">co_sites</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">])</span>
<span class="n">ddf</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 462 ms, sys: 123 ms, total: 585 ms
Wall time: 849 ms
</pre></div>
</div>
<div class="output text_html"><div><strong>Dask DataFrame Structure:</strong></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE</th>
      <th>ID</th>
      <th>YEAR</th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>TMAX</th>
      <th>TMAX_FLAGS</th>
      <th>TMIN</th>
      <th>TMIN_FLAGS</th>
      <th>PRCP</th>
      <th>PRCP_FLAGS</th>
      <th>SNOW</th>
      <th>SNOW_FLAGS</th>
      <th>SNWD</th>
      <th>SNWD_FLAGS</th>
      <th>WT16</th>
      <th>WT16_FLAGS</th>
      <th>WT14</th>
      <th>WT14_FLAGS</th>
      <th>WT18</th>
      <th>WT18_FLAGS</th>
      <th>TOBS</th>
      <th>TOBS_FLAGS</th>
      <th>WT01</th>
      <th>WT01_FLAGS</th>
      <th>WT08</th>
      <th>WT08_FLAGS</th>
      <th>WT03</th>
      <th>WT03_FLAGS</th>
      <th>WT04</th>
      <th>WT04_FLAGS</th>
      <th>WT06</th>
      <th>WT06_FLAGS</th>
      <th>WT05</th>
      <th>WT05_FLAGS</th>
      <th>DAPR</th>
      <th>DAPR_FLAGS</th>
      <th>MDPR</th>
      <th>MDPR_FLAGS</th>
      <th>WT11</th>
      <th>WT11_FLAGS</th>
      <th>SN02</th>
      <th>SN02_FLAGS</th>
      <th>SX02</th>
      <th>SX02_FLAGS</th>
      <th>SN32</th>
      <th>SN32_FLAGS</th>
      <th>SX32</th>
      <th>SX32_FLAGS</th>
      <th>SN52</th>
      <th>SN52_FLAGS</th>
      <th>SX52</th>
      <th>SX52_FLAGS</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>ELEVATION</th>
      <th>STATE</th>
      <th>STATION</th>
    </tr>
    <tr>
      <th>npartitions=66</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th></th>
      <td>datetime64[ns]</td>
      <td>object</td>
      <td>int64</td>
      <td>int64</td>
      <td>int64</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>object</td>
      <td>float64</td>
      <td>float64</td>
      <td>float64</td>
      <td>object</td>
      <td>object</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th></th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
  </tbody>
</table>
</div>
<div>Dask Name: read-csv, 66 tasks</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddf</span><span class="o">.</span><span class="n">TMAX</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dd.Scalar&lt;series-..., dtype=float64&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>Notice that the representation of the DataFrame object contains no data just headers and datatypes.  Why?</strong></p>
<section id="lazy-evaluation">
<h4>Lazy Evaluation<a class="headerlink" href="#lazy-evaluation" title="Permalink to this heading">#</a></h4>
<p>Similar to Dask Arrays, Dask DataFrames are lazy. Here the data has not yet been read into the dataframe yet (a.k.a. lazy evaluation).<br />
Dask just construct the task graph of the computation but it will “evaluate” them only when necessary.</p>
<p><strong>So how does Dask know the name and dtype of each column?</strong></p>
<p>Dask has just read the start of the first file and infers the column names and dtypes.</p>
<p>Unlike <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code> that reads in all files before inferring data types, <code class="docutils literal notranslate"><span class="pre">dask.dataframe.read_csv</span></code> only reads in a sample from the beginning of the file (or first file if using a glob). The column names and dtypes are then enforced when reading the specific partitions (<em>Dask can make mistakes on these inferences if there is missing or misleading data in the early rows</em>).</p>
<p>Let’s take a look at the start of our dataframe:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ddf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DATE</th>
      <th>ID</th>
      <th>YEAR</th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>TMAX</th>
      <th>TMAX_FLAGS</th>
      <th>TMIN</th>
      <th>TMIN_FLAGS</th>
      <th>PRCP</th>
      <th>...</th>
      <th>SX32_FLAGS</th>
      <th>SN52</th>
      <th>SN52_FLAGS</th>
      <th>SX52</th>
      <th>SX52_FLAGS</th>
      <th>LATITUDE</th>
      <th>LONGITUDE</th>
      <th>ELEVATION</th>
      <th>STATE</th>
      <th>STATION</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1884-04-01</td>
      <td>USC00035186</td>
      <td>1884</td>
      <td>4</td>
      <td>1</td>
      <td>289.0</td>
      <td>XX6</td>
      <td>222.0</td>
      <td>XX6</td>
      <td>0.0</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>35.6042</td>
      <td>-91.2744</td>
      <td>69.5</td>
      <td>AR</td>
      <td>NEWPORT</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1884-04-02</td>
      <td>USC00035186</td>
      <td>1884</td>
      <td>4</td>
      <td>2</td>
      <td>272.0</td>
      <td>XX6</td>
      <td>89.0</td>
      <td>XX6</td>
      <td>0.0</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>35.6042</td>
      <td>-91.2744</td>
      <td>69.5</td>
      <td>AR</td>
      <td>NEWPORT</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1884-04-03</td>
      <td>USC00035186</td>
      <td>1884</td>
      <td>4</td>
      <td>3</td>
      <td>200.0</td>
      <td>XX6</td>
      <td>22.0</td>
      <td>XX6</td>
      <td>0.0</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>35.6042</td>
      <td>-91.2744</td>
      <td>69.5</td>
      <td>AR</td>
      <td>NEWPORT</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1884-04-04</td>
      <td>USC00035186</td>
      <td>1884</td>
      <td>4</td>
      <td>4</td>
      <td>244.0</td>
      <td>XX6</td>
      <td>61.0</td>
      <td>XX6</td>
      <td>0.0</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>35.6042</td>
      <td>-91.2744</td>
      <td>69.5</td>
      <td>AR</td>
      <td>NEWPORT</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1884-04-08</td>
      <td>USC00035186</td>
      <td>1884</td>
      <td>4</td>
      <td>8</td>
      <td>178.0</td>
      <td>XX6</td>
      <td>39.0</td>
      <td>XX6</td>
      <td>0.0</td>
      <td>...</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>NaN</td>
      <td>XXX</td>
      <td>35.6042</td>
      <td>-91.2744</td>
      <td>69.5</td>
      <td>AR</td>
      <td>NEWPORT</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 58 columns</p>
</div></div></div>
</div>
<div class="alert alert-block alert-info" markdown="1">
<p><b>NOTE:</b>  Whenever we operate on our dataframe we read through all of our CSV data so that we don’t fill up RAM. Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible. This enables you to handle larger than memory datasets but, repeated computations will have to load all of the data in each time.</p>
</div><p>Similar data manipulations as <code class="docutils literal notranslate"><span class="pre">pandas.dataframe</span></code> can be done for <code class="docutils literal notranslate"><span class="pre">dask.dataframes</span></code>.<br />
For example, let’s find the highest number of snow days in Colorado:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;This site has the highest number of snow days in a year : &#39;</span><span class="p">)</span>
<span class="n">snowy_days</span> <span class="o">=</span> <span class="n">ddf</span><span class="p">[</span><span class="n">ddf</span><span class="p">[</span><span class="s1">&#39;SNOW&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;ID&#39;</span><span class="p">,</span><span class="s1">&#39;YEAR&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
<span class="n">snowy_days</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s1">&#39;idxmax&#39;</span><span class="p">,</span><span class="s1">&#39;max&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This site has the highest number of snow days in a year : 
CPU times: user 236 ms, sys: 54.1 ms, total: 290 ms
Wall time: 4.62 s
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>idxmax    (USC00052281, 1983)
max                       102
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section id="nice-but-what-did-dask-do">
<h4>Nice, but what did Dask do?<a class="headerlink" href="#nice-but-what-did-dask-do" title="Permalink to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Requires ipywidgets</span>

<span class="n">snowy_days</span><span class="o">.</span><span class="n">dask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div>
        <div style="width: 52px; height: 52px; position: absolute;">
            <svg width="76" height="71" viewBox="0 0 76 71" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="61.5" cy="36.5" r="13.5" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2"/>
                <circle cx="14.5" cy="14.5" r="13.5" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2"/>
                <circle cx="14.5" cy="56.5" r="13.5" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2"/>
                <path d="M28 16L30.5 16C33.2614 16 35.5 18.2386 35.5 21L35.5 32.0001C35.5 34.7615 37.7386 37.0001 40.5 37.0001L43 37.0001" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"/>
                <path d="M40.5 37L40.5 37.75L40.5 37.75L40.5 37ZM35.5 42L36.25 42L35.5 42ZM35.5 52L34.75 52L35.5 52ZM30.5 57L30.5 57.75L30.5 57ZM41.5001 36.25L40.5 36.25L40.5 37.75L41.5001 37.75L41.5001 36.25ZM34.75 42L34.75 52L36.25 52L36.25 42L34.75 42ZM30.5 56.25L28.0001 56.25L28.0001 57.75L30.5 57.75L30.5 56.25ZM34.75 52C34.75 54.3472 32.8472 56.25 30.5 56.25L30.5 57.75C33.6756 57.75 36.25 55.1756 36.25 52L34.75 52ZM40.5 36.25C37.3244 36.25 34.75 38.8243 34.75 42L36.25 42C36.25 39.6528 38.1528 37.75 40.5 37.75L40.5 36.25Z" style="fill: var(--jp-ui-font-color2, #1D1D1D);"/>
                <circle cx="28" cy="16" r="2.25" fill="#E5E5E5" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"/>
                <circle cx="28" cy="57" r="2.25" fill="#E5E5E5" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"/>
                <path d="M45.25 36.567C45.5833 36.7594 45.5833 37.2406 45.25 37.433L42.25 39.1651C41.9167 39.3575 41.5 39.117 41.5 38.7321V35.2679C41.5 34.883 41.9167 34.6425 42.25 34.8349L45.25 36.567Z" style="fill: var(--jp-ui-font-color2, #1D1D1D);"/>
            </svg>
        </div>
        <div style="margin-left: 64px;">
            <h3 style="margin-bottom: 0px;">HighLevelGraph</h3>
            <p style="color: var(--jp-ui-font-color2, #5D5851); margin-bottom:0px;">
                HighLevelGraph with 6 layers and 331 keys from all layers.
            </p>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer1: read-csv</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            read-csv-5f2d7502b7b2ca095255b707b5fa92b8
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">DataFrameIOLayer</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">npartitions</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">columns</th>
                        <td style="text-align: left;">[&#x27;DATE&#x27;, &#x27;ID&#x27;, &#x27;YEAR&#x27;, &#x27;MONTH&#x27;, &#x27;DAY&#x27;, &#x27;TMAX&#x27;, &#x27;TMAX_FLAGS&#x27;, &#x27;TMIN&#x27;, &#x27;TMIN_FLAGS&#x27;, &#x27;PRCP&#x27;, &#x27;PRCP_FLAGS&#x27;, &#x27;SNOW&#x27;, &#x27;SNOW_FLAGS&#x27;, &#x27;SNWD&#x27;, &#x27;SNWD_FLAGS&#x27;, &#x27;WT16&#x27;, &#x27;WT16_FLAGS&#x27;, &#x27;WT14&#x27;, &#x27;WT14_FLAGS&#x27;, &#x27;WT18&#x27;, &#x27;WT18_FLAGS&#x27;, &#x27;TOBS&#x27;, &#x27;TOBS_FLAGS&#x27;, &#x27;WT01&#x27;, &#x27;WT01_FLAGS&#x27;, &#x27;WT08&#x27;, &#x27;WT08_FLAGS&#x27;, &#x27;WT03&#x27;, &#x27;WT03_FLAGS&#x27;, &#x27;WT04&#x27;, &#x27;WT04_FLAGS&#x27;, &#x27;WT06&#x27;, &#x27;WT06_FLAGS&#x27;, &#x27;WT05&#x27;, &#x27;WT05_FLAGS&#x27;, &#x27;DAPR&#x27;, &#x27;DAPR_FLAGS&#x27;, &#x27;MDPR&#x27;, &#x27;MDPR_FLAGS&#x27;, &#x27;WT11&#x27;, &#x27;WT11_FLAGS&#x27;, &#x27;SN02&#x27;, &#x27;SN02_FLAGS&#x27;, &#x27;SX02&#x27;, &#x27;SX02_FLAGS&#x27;, &#x27;SN32&#x27;, &#x27;SN32_FLAGS&#x27;, &#x27;SX32&#x27;, &#x27;SX32_FLAGS&#x27;, &#x27;SN52&#x27;, &#x27;SN52_FLAGS&#x27;, &#x27;SX52&#x27;, &#x27;SX52_FLAGS&#x27;, &#x27;LATITUDE&#x27;, &#x27;LONGITUDE&#x27;, &#x27;ELEVATION&#x27;, &#x27;STATE&#x27;, &#x27;STATION&#x27;]</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">type</th>
                        <td style="text-align: left;">dask.dataframe.core.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">dataframe_type</th>
                        <td style="text-align: left;">pandas.core.frame.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">series_dtypes</th>
                        <td style="text-align: left;">{&#x27;DATE&#x27;: dtype(&#x27;&lt;M8[ns]&#x27;), &#x27;ID&#x27;: dtype(&#x27;O&#x27;), &#x27;YEAR&#x27;: dtype(&#x27;int64&#x27;), &#x27;MONTH&#x27;: dtype(&#x27;int64&#x27;), &#x27;DAY&#x27;: dtype(&#x27;int64&#x27;), &#x27;TMAX&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMAX_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TMIN&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMIN_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;PRCP&#x27;: dtype(&#x27;float64&#x27;), &#x27;PRCP_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNOW&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNOW_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNWD&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNWD_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT16&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT16_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT14&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT14_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT18&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT18_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TOBS&#x27;: dtype(&#x27;float64&#x27;), &#x27;TOBS_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT01&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT01_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT08&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT08_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT03&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT03_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT04&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT04_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT06&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT06_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT05&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT05_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;DAPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;DAPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;MDPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;MDPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT11&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT11_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;LATITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;LONGITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;ELEVATION&#x27;: dtype(&#x27;float64&#x27;), &#x27;STATE&#x27;: dtype(&#x27;O&#x27;), &#x27;STATION&#x27;: dtype(&#x27;O&#x27;)}</td>
                    </tr>
                
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer2: getitem</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            getitem-51dd26ae1d79cd0e667caf194aa506cd
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">read-csv-5f2d7502b7b2ca095255b707b5fa92b8</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer3: gt</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            gt-4dc2c28c5c6a8a61c8e747e16a43b818
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">getitem-51dd26ae1d79cd0e667caf194aa506cd</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer4: getitem</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            getitem-92164db053c94adfa8b699f100d8db26
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">npartitions</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">columns</th>
                        <td style="text-align: left;">[&#x27;DATE&#x27;, &#x27;ID&#x27;, &#x27;YEAR&#x27;, &#x27;MONTH&#x27;, &#x27;DAY&#x27;, &#x27;TMAX&#x27;, &#x27;TMAX_FLAGS&#x27;, &#x27;TMIN&#x27;, &#x27;TMIN_FLAGS&#x27;, &#x27;PRCP&#x27;, &#x27;PRCP_FLAGS&#x27;, &#x27;SNOW&#x27;, &#x27;SNOW_FLAGS&#x27;, &#x27;SNWD&#x27;, &#x27;SNWD_FLAGS&#x27;, &#x27;WT16&#x27;, &#x27;WT16_FLAGS&#x27;, &#x27;WT14&#x27;, &#x27;WT14_FLAGS&#x27;, &#x27;WT18&#x27;, &#x27;WT18_FLAGS&#x27;, &#x27;TOBS&#x27;, &#x27;TOBS_FLAGS&#x27;, &#x27;WT01&#x27;, &#x27;WT01_FLAGS&#x27;, &#x27;WT08&#x27;, &#x27;WT08_FLAGS&#x27;, &#x27;WT03&#x27;, &#x27;WT03_FLAGS&#x27;, &#x27;WT04&#x27;, &#x27;WT04_FLAGS&#x27;, &#x27;WT06&#x27;, &#x27;WT06_FLAGS&#x27;, &#x27;WT05&#x27;, &#x27;WT05_FLAGS&#x27;, &#x27;DAPR&#x27;, &#x27;DAPR_FLAGS&#x27;, &#x27;MDPR&#x27;, &#x27;MDPR_FLAGS&#x27;, &#x27;WT11&#x27;, &#x27;WT11_FLAGS&#x27;, &#x27;SN02&#x27;, &#x27;SN02_FLAGS&#x27;, &#x27;SX02&#x27;, &#x27;SX02_FLAGS&#x27;, &#x27;SN32&#x27;, &#x27;SN32_FLAGS&#x27;, &#x27;SX32&#x27;, &#x27;SX32_FLAGS&#x27;, &#x27;SN52&#x27;, &#x27;SN52_FLAGS&#x27;, &#x27;SX52&#x27;, &#x27;SX52_FLAGS&#x27;, &#x27;LATITUDE&#x27;, &#x27;LONGITUDE&#x27;, &#x27;ELEVATION&#x27;, &#x27;STATE&#x27;, &#x27;STATION&#x27;]</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">type</th>
                        <td style="text-align: left;">dask.dataframe.core.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">dataframe_type</th>
                        <td style="text-align: left;">pandas.core.frame.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">series_dtypes</th>
                        <td style="text-align: left;">{&#x27;DATE&#x27;: dtype(&#x27;&lt;M8[ns]&#x27;), &#x27;ID&#x27;: dtype(&#x27;O&#x27;), &#x27;YEAR&#x27;: dtype(&#x27;int64&#x27;), &#x27;MONTH&#x27;: dtype(&#x27;int64&#x27;), &#x27;DAY&#x27;: dtype(&#x27;int64&#x27;), &#x27;TMAX&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMAX_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TMIN&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMIN_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;PRCP&#x27;: dtype(&#x27;float64&#x27;), &#x27;PRCP_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNOW&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNOW_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNWD&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNWD_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT16&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT16_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT14&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT14_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT18&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT18_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TOBS&#x27;: dtype(&#x27;float64&#x27;), &#x27;TOBS_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT01&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT01_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT08&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT08_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT03&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT03_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT04&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT04_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT06&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT06_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT05&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT05_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;DAPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;DAPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;MDPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;MDPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT11&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT11_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;LATITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;LONGITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;ELEVATION&#x27;: dtype(&#x27;float64&#x27;), &#x27;STATE&#x27;: dtype(&#x27;O&#x27;), &#x27;STATION&#x27;: dtype(&#x27;O&#x27;)}</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">gt-4dc2c28c5c6a8a61c8e747e16a43b818</td>
                        </tr>
                    
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"></th>
                            <td style="text-align: left;">read-csv-5f2d7502b7b2ca095255b707b5fa92b8</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer5: dataframe-groupby-size-chunk</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            dataframe-groupby-size-chunk-b11331e4b541606fb356e0ef3871f13d-785f1ed81a41cfe4eeefc53d30e1ed67
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">getitem-92164db053c94adfa8b699f100d8db26</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer6: dataframe-groupby-size-agg</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            dataframe-groupby-size-agg-b11331e4b541606fb356e0ef3871f13d
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">DataFrameTreeReduction</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">1</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">dataframe-groupby-size-chunk-b11331e4b541606fb356e0ef3871f13d-785f1ed81a41cfe4eeefc53d30e1ed67</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
        </div>
    </div>
</div></div></div>
</div>
<p>You can also view the underlying task graph using <code class="docutils literal notranslate"><span class="pre">.visualize()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#graph is too large</span>
<span class="n">snowy_days</span><span class="o">.</span><span class="n">visualize</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2023-02-05 14:09:25,213 - distributed.client - ERROR - Failed to reconnect to scheduler after 30.00 seconds, closing client
</pre></div>
</div>
<img alt="../_images/1516d76f4ab66bd22b2a845d8234e256875261351b633d9fd87707bbea77204b.png" src="../_images/1516d76f4ab66bd22b2a845d8234e256875261351b633d9fd87707bbea77204b.png" />
</div>
</div>
</section>
</section>
<section id="use-compute-wisely">
<h3>Use <code class="docutils literal notranslate"><span class="pre">.compute</span></code> wisely!<a class="headerlink" href="#use-compute-wisely" title="Permalink to this heading">#</a></h3>
<section id="share-intermediate-results">
<h4>Share intermediate results<a class="headerlink" href="#share-intermediate-results" title="Permalink to this heading">#</a></h4>
<p>For most operations, <code class="docutils literal notranslate"><span class="pre">dask.dataframe</span></code> hashes the arguments, allowing duplicate computations to be shared, and only computed once.</p>
<p>For example, let’s compute the mean and standard deviation for Maximum daily temperature of all snow days.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">snowy_days</span> <span class="o">=</span> <span class="n">ddf</span><span class="p">[</span><span class="n">ddf</span><span class="p">[</span><span class="s1">&#39;SNOW&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
<span class="n">mean_tmax</span> <span class="o">=</span> <span class="n">snowy_days</span><span class="o">.</span><span class="n">TMAX</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_tmax</span> <span class="o">=</span> <span class="n">snowy_days</span><span class="o">.</span><span class="n">TMAX</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">mean_tmax_result</span> <span class="o">=</span> <span class="n">mean_tmax</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">std_tmax_result</span> <span class="o">=</span> <span class="n">std_tmax</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 24.9 s, sys: 2.12 s, total: 27 s
Wall time: 15.4 s
</pre></div>
</div>
</div>
</div>
<p>But if we pass both arguments in a single <code class="docutils literal notranslate"><span class="pre">.compute</span></code>, we can share the intermediate results:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">mean_tmax_result</span><span class="p">,</span> <span class="n">std_tmax_result</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">mean_tmax</span><span class="p">,</span> <span class="n">std_tmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 11.6 s, sys: 770 ms, total: 12.4 s
Wall time: 7.05 s
</pre></div>
</div>
</div>
</div>
<p>Here using <code class="docutils literal notranslate"><span class="pre">dask.compute</span></code> only one allowed sharing intermediate results between TMAX mean and median calculations and improved total performance.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_tmax</span><span class="o">.</span><span class="n">dask</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div>
        <div style="width: 52px; height: 52px; position: absolute;">
            <svg width="76" height="71" viewBox="0 0 76 71" fill="none" xmlns="http://www.w3.org/2000/svg">
                <circle cx="61.5" cy="36.5" r="13.5" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2"/>
                <circle cx="14.5" cy="14.5" r="13.5" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2"/>
                <circle cx="14.5" cy="56.5" r="13.5" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2"/>
                <path d="M28 16L30.5 16C33.2614 16 35.5 18.2386 35.5 21L35.5 32.0001C35.5 34.7615 37.7386 37.0001 40.5 37.0001L43 37.0001" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"/>
                <path d="M40.5 37L40.5 37.75L40.5 37.75L40.5 37ZM35.5 42L36.25 42L35.5 42ZM35.5 52L34.75 52L35.5 52ZM30.5 57L30.5 57.75L30.5 57ZM41.5001 36.25L40.5 36.25L40.5 37.75L41.5001 37.75L41.5001 36.25ZM34.75 42L34.75 52L36.25 52L36.25 42L34.75 42ZM30.5 56.25L28.0001 56.25L28.0001 57.75L30.5 57.75L30.5 56.25ZM34.75 52C34.75 54.3472 32.8472 56.25 30.5 56.25L30.5 57.75C33.6756 57.75 36.25 55.1756 36.25 52L34.75 52ZM40.5 36.25C37.3244 36.25 34.75 38.8243 34.75 42L36.25 42C36.25 39.6528 38.1528 37.75 40.5 37.75L40.5 36.25Z" style="fill: var(--jp-ui-font-color2, #1D1D1D);"/>
                <circle cx="28" cy="16" r="2.25" fill="#E5E5E5" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"/>
                <circle cx="28" cy="57" r="2.25" fill="#E5E5E5" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="1.5"/>
                <path d="M45.25 36.567C45.5833 36.7594 45.5833 37.2406 45.25 37.433L42.25 39.1651C41.9167 39.3575 41.5 39.117 41.5 38.7321V35.2679C41.5 34.883 41.9167 34.6425 42.25 34.8349L45.25 36.567Z" style="fill: var(--jp-ui-font-color2, #1D1D1D);"/>
            </svg>
        </div>
        <div style="margin-left: 64px;">
            <h3 style="margin-bottom: 0px;">HighLevelGraph</h3>
            <p style="color: var(--jp-ui-font-color2, #5D5851); margin-bottom:0px;">
                HighLevelGraph with 10 layers and 465 keys from all layers.
            </p>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" fill="#8F8F8F" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="2"/>
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer1: read-csv</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            read-csv-5f2d7502b7b2ca095255b707b5fa92b8
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">DataFrameIOLayer</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">True</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">npartitions</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">columns</th>
                        <td style="text-align: left;">[&#x27;DATE&#x27;, &#x27;ID&#x27;, &#x27;YEAR&#x27;, &#x27;MONTH&#x27;, &#x27;DAY&#x27;, &#x27;TMAX&#x27;, &#x27;TMAX_FLAGS&#x27;, &#x27;TMIN&#x27;, &#x27;TMIN_FLAGS&#x27;, &#x27;PRCP&#x27;, &#x27;PRCP_FLAGS&#x27;, &#x27;SNOW&#x27;, &#x27;SNOW_FLAGS&#x27;, &#x27;SNWD&#x27;, &#x27;SNWD_FLAGS&#x27;, &#x27;WT16&#x27;, &#x27;WT16_FLAGS&#x27;, &#x27;WT14&#x27;, &#x27;WT14_FLAGS&#x27;, &#x27;WT18&#x27;, &#x27;WT18_FLAGS&#x27;, &#x27;TOBS&#x27;, &#x27;TOBS_FLAGS&#x27;, &#x27;WT01&#x27;, &#x27;WT01_FLAGS&#x27;, &#x27;WT08&#x27;, &#x27;WT08_FLAGS&#x27;, &#x27;WT03&#x27;, &#x27;WT03_FLAGS&#x27;, &#x27;WT04&#x27;, &#x27;WT04_FLAGS&#x27;, &#x27;WT06&#x27;, &#x27;WT06_FLAGS&#x27;, &#x27;WT05&#x27;, &#x27;WT05_FLAGS&#x27;, &#x27;DAPR&#x27;, &#x27;DAPR_FLAGS&#x27;, &#x27;MDPR&#x27;, &#x27;MDPR_FLAGS&#x27;, &#x27;WT11&#x27;, &#x27;WT11_FLAGS&#x27;, &#x27;SN02&#x27;, &#x27;SN02_FLAGS&#x27;, &#x27;SX02&#x27;, &#x27;SX02_FLAGS&#x27;, &#x27;SN32&#x27;, &#x27;SN32_FLAGS&#x27;, &#x27;SX32&#x27;, &#x27;SX32_FLAGS&#x27;, &#x27;SN52&#x27;, &#x27;SN52_FLAGS&#x27;, &#x27;SX52&#x27;, &#x27;SX52_FLAGS&#x27;, &#x27;LATITUDE&#x27;, &#x27;LONGITUDE&#x27;, &#x27;ELEVATION&#x27;, &#x27;STATE&#x27;, &#x27;STATION&#x27;]</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">type</th>
                        <td style="text-align: left;">dask.dataframe.core.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">dataframe_type</th>
                        <td style="text-align: left;">pandas.core.frame.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">series_dtypes</th>
                        <td style="text-align: left;">{&#x27;DATE&#x27;: dtype(&#x27;&lt;M8[ns]&#x27;), &#x27;ID&#x27;: dtype(&#x27;O&#x27;), &#x27;YEAR&#x27;: dtype(&#x27;int64&#x27;), &#x27;MONTH&#x27;: dtype(&#x27;int64&#x27;), &#x27;DAY&#x27;: dtype(&#x27;int64&#x27;), &#x27;TMAX&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMAX_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TMIN&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMIN_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;PRCP&#x27;: dtype(&#x27;float64&#x27;), &#x27;PRCP_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNOW&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNOW_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNWD&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNWD_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT16&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT16_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT14&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT14_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT18&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT18_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TOBS&#x27;: dtype(&#x27;float64&#x27;), &#x27;TOBS_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT01&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT01_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT08&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT08_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT03&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT03_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT04&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT04_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT06&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT06_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT05&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT05_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;DAPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;DAPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;MDPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;MDPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT11&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT11_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;LATITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;LONGITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;ELEVATION&#x27;: dtype(&#x27;float64&#x27;), &#x27;STATE&#x27;: dtype(&#x27;O&#x27;), &#x27;STATION&#x27;: dtype(&#x27;O&#x27;)}</td>
                    </tr>
                
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer2: getitem</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            getitem-51dd26ae1d79cd0e667caf194aa506cd
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">read-csv-5f2d7502b7b2ca095255b707b5fa92b8</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer3: gt</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            gt-4dc2c28c5c6a8a61c8e747e16a43b818
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">getitem-51dd26ae1d79cd0e667caf194aa506cd</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer4: getitem</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            getitem-92164db053c94adfa8b699f100d8db26
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">npartitions</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">columns</th>
                        <td style="text-align: left;">[&#x27;DATE&#x27;, &#x27;ID&#x27;, &#x27;YEAR&#x27;, &#x27;MONTH&#x27;, &#x27;DAY&#x27;, &#x27;TMAX&#x27;, &#x27;TMAX_FLAGS&#x27;, &#x27;TMIN&#x27;, &#x27;TMIN_FLAGS&#x27;, &#x27;PRCP&#x27;, &#x27;PRCP_FLAGS&#x27;, &#x27;SNOW&#x27;, &#x27;SNOW_FLAGS&#x27;, &#x27;SNWD&#x27;, &#x27;SNWD_FLAGS&#x27;, &#x27;WT16&#x27;, &#x27;WT16_FLAGS&#x27;, &#x27;WT14&#x27;, &#x27;WT14_FLAGS&#x27;, &#x27;WT18&#x27;, &#x27;WT18_FLAGS&#x27;, &#x27;TOBS&#x27;, &#x27;TOBS_FLAGS&#x27;, &#x27;WT01&#x27;, &#x27;WT01_FLAGS&#x27;, &#x27;WT08&#x27;, &#x27;WT08_FLAGS&#x27;, &#x27;WT03&#x27;, &#x27;WT03_FLAGS&#x27;, &#x27;WT04&#x27;, &#x27;WT04_FLAGS&#x27;, &#x27;WT06&#x27;, &#x27;WT06_FLAGS&#x27;, &#x27;WT05&#x27;, &#x27;WT05_FLAGS&#x27;, &#x27;DAPR&#x27;, &#x27;DAPR_FLAGS&#x27;, &#x27;MDPR&#x27;, &#x27;MDPR_FLAGS&#x27;, &#x27;WT11&#x27;, &#x27;WT11_FLAGS&#x27;, &#x27;SN02&#x27;, &#x27;SN02_FLAGS&#x27;, &#x27;SX02&#x27;, &#x27;SX02_FLAGS&#x27;, &#x27;SN32&#x27;, &#x27;SN32_FLAGS&#x27;, &#x27;SX32&#x27;, &#x27;SX32_FLAGS&#x27;, &#x27;SN52&#x27;, &#x27;SN52_FLAGS&#x27;, &#x27;SX52&#x27;, &#x27;SX52_FLAGS&#x27;, &#x27;LATITUDE&#x27;, &#x27;LONGITUDE&#x27;, &#x27;ELEVATION&#x27;, &#x27;STATE&#x27;, &#x27;STATION&#x27;]</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">type</th>
                        <td style="text-align: left;">dask.dataframe.core.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">dataframe_type</th>
                        <td style="text-align: left;">pandas.core.frame.DataFrame</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">series_dtypes</th>
                        <td style="text-align: left;">{&#x27;DATE&#x27;: dtype(&#x27;&lt;M8[ns]&#x27;), &#x27;ID&#x27;: dtype(&#x27;O&#x27;), &#x27;YEAR&#x27;: dtype(&#x27;int64&#x27;), &#x27;MONTH&#x27;: dtype(&#x27;int64&#x27;), &#x27;DAY&#x27;: dtype(&#x27;int64&#x27;), &#x27;TMAX&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMAX_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TMIN&#x27;: dtype(&#x27;float64&#x27;), &#x27;TMIN_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;PRCP&#x27;: dtype(&#x27;float64&#x27;), &#x27;PRCP_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNOW&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNOW_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SNWD&#x27;: dtype(&#x27;float64&#x27;), &#x27;SNWD_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT16&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT16_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT14&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT14_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT18&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT18_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;TOBS&#x27;: dtype(&#x27;float64&#x27;), &#x27;TOBS_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT01&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT01_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT08&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT08_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT03&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT03_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT04&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT04_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT06&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT06_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT05&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT05_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;DAPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;DAPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;MDPR&#x27;: dtype(&#x27;float64&#x27;), &#x27;MDPR_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;WT11&#x27;: dtype(&#x27;float64&#x27;), &#x27;WT11_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX02&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX02_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX32&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX32_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SN52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SN52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;SX52&#x27;: dtype(&#x27;float64&#x27;), &#x27;SX52_FLAGS&#x27;: dtype(&#x27;O&#x27;), &#x27;LATITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;LONGITUDE&#x27;: dtype(&#x27;float64&#x27;), &#x27;ELEVATION&#x27;: dtype(&#x27;float64&#x27;), &#x27;STATE&#x27;: dtype(&#x27;O&#x27;), &#x27;STATION&#x27;: dtype(&#x27;O&#x27;)}</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">gt-4dc2c28c5c6a8a61c8e747e16a43b818</td>
                        </tr>
                    
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"></th>
                            <td style="text-align: left;">read-csv-5f2d7502b7b2ca095255b707b5fa92b8</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" style="stroke: var(--jp-ui-font-color2, #1D1D1D); fill: var(--jp-layout-color1, #F2F2F2);" stroke-width="2" />
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer5: getitem</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            getitem-ae71d69b1bed81ae1d1b31cbde77b2d1
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">False</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">getitem-92164db053c94adfa8b699f100d8db26</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" fill="#8F8F8F" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="2"/>
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer6: series-count-chunk</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            series-count-chunk-abb2ff16056a172d5fef3143ffcb9e09-fe4c70e18b085589f8043db033af3fbf
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">True</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">getitem-ae71d69b1bed81ae1d1b31cbde77b2d1</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" fill="#8F8F8F" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="2"/>
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer7: series-count-agg</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            series-count-agg-abb2ff16056a172d5fef3143ffcb9e09
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">DataFrameTreeReduction</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">True</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">1</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">series-count-chunk-abb2ff16056a172d5fef3143ffcb9e09-fe4c70e18b085589f8043db033af3fbf</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" fill="#8F8F8F" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="2"/>
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer8: series-sum-chunk</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            series-sum-chunk-42eb529730624a32128fcee5962b541b-5e7bf346d21035fc08bd8dcd180f8226
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">Blockwise</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">True</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">66</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">getitem-ae71d69b1bed81ae1d1b31cbde77b2d1</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" fill="#8F8F8F" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="2"/>
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer9: series-sum-agg</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            series-sum-agg-42eb529730624a32128fcee5962b541b
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">DataFrameTreeReduction</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">True</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">1</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">series-sum-chunk-42eb529730624a32128fcee5962b541b-5e7bf346d21035fc08bd8dcd180f8226</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
            <div style="">
    <svg width="24" height="24" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" style="position: absolute;">
        
        <circle cx="16" cy="16" r="14" fill="#8F8F8F" style="stroke: var(--jp-ui-font-color2, #1D1D1D);" stroke-width="2"/>
        
    </svg>

    <details style="margin-left: 32px;">
        <summary style="margin-bottom: 10px; margin-top: 10px;">
            <h4 style="display: inline;">Layer10: series-mean</h4>
        </summary>
        <p style="color: var(--jp-ui-font-color2, #5D5851); margin: -0.25em 0px 0px 0px;">
            series-mean-ba3bd33250f8158b201e128be511cd80-659f48717192b044106eef74633c1a2c
        </p>

        <table>
        <tr>
            <td>
                <table>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">layer_type</th>
                        <td style="text-align: left;">MaterializedLayer</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">is_materialized</th>
                        <td style="text-align: left;">True</td>
                    </tr>
                
                    <tr>
                        <th style="text-align: left; width: 150px;">number of outputs</th>
                        <td style="text-align: left;">1</td>
                    </tr>
                
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"> depends on </th>
                            <td style="text-align: left;">series-sum-agg-42eb529730624a32128fcee5962b541b</td>
                        </tr>
                    
                
                    
                        <tr>
                            <th style="text-align: left; width: 150px;"></th>
                            <td style="text-align: left;">series-count-agg-abb2ff16056a172d5fef3143ffcb9e09</td>
                        </tr>
                    
                
                </table>
            </td>
            <td>
                
            </td>
        </tr>
        </table>

    </details>
</div>
            
        </div>
    </div>
</div></div></div>
</div>
<p>Here some operations such as the calls to read the csv files, the filtering, and the grouping is exactly similar between both operations, so they can share intermediate results. Remember, Dask will delete intermediate results (like the full pandas DataFrame for each file) as soon as possible.</p>
</section>
</section>
<section id="persist-or-caching">
<h3><code class="docutils literal notranslate"><span class="pre">.persist</span></code> or caching<a class="headerlink" href="#persist-or-caching" title="Permalink to this heading">#</a></h3>
<p>Sometimes you might want your computers to keep intermediate results in memory, if it fits in the memory.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">.persist()</span></code> method can be used to  “cache” data and tell Dask what results to keep around. You should only use <code class="docutils literal notranslate"><span class="pre">.persist()</span></code> with any data or computation that fits in memory.</p>
<p>For example, if we want to only do analysis on a subset of data (for example snow days at Boulder site):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boulder_snow</span> <span class="o">=</span> <span class="n">ddf</span><span class="p">[(</span><span class="n">ddf</span><span class="p">[</span><span class="s1">&#39;SNOW&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">ddf</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USC00050848&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="n">boulder_snow</span><span class="o">.</span><span class="n">TMAX</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="n">boulder_snow</span><span class="o">.</span><span class="n">TMIN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-74.82074711099168 37.419103836866114
CPU times: user 23.8 s, sys: 1.94 s, total: 25.7 s
Wall time: 14.6 s
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">boulder_snow</span> <span class="o">=</span> <span class="n">ddf</span><span class="p">[(</span><span class="n">ddf</span><span class="p">[</span><span class="s1">&#39;SNOW&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="o">&amp;</span><span class="p">(</span><span class="n">ddf</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;USC00050848&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">persist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">tmax</span> <span class="o">=</span> <span class="n">boulder_snow</span><span class="o">.</span><span class="n">TMAX</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="n">boulder_snow</span><span class="o">.</span><span class="n">TMIN</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-74.82074711099168 37.419103836866114
CPU times: user 51.9 ms, sys: 4.82 ms, total: 56.7 ms
Wall time: 53.7 ms
</pre></div>
</div>
</div>
</div>
<p>As you can see the analysis on this persisted data is much faster because we are not repeating the loading and selecting.</p>
</section>
</section>
<section id="dask-dataframes-best-practices">
<h2>Dask DataFrames Best Practices<a class="headerlink" href="#dask-dataframes-best-practices" title="Permalink to this heading">#</a></h2>
<section id="use-pandas-when-you-can">
<h3>Use pandas (when you can)<a class="headerlink" href="#use-pandas-when-you-can" title="Permalink to this heading">#</a></h3>
<p>For data that fits into RAM, pandas can often be easier and more efficient to use than Dask DataFrame. However, Dask DataFrame is a powerful tool for larger-than-memory datasets.</p>
<p>When the data is still larger than memory, Dask DataFrame can be used to <strong>reduce</strong> the larger datasets to a manageable level that pandas can handle. Next, use pandas at that point.</p>
</section>
<section id="avoid-full-data-shuffling">
<h3>Avoid Full-Data Shuffling<a class="headerlink" href="#avoid-full-data-shuffling" title="Permalink to this heading">#</a></h3>
<p>Some operations are more expensive to compute in a parallel setting than if they are in-memory on a single machine (for example, <code class="docutils literal notranslate"><span class="pre">set_index</span></code> or <code class="docutils literal notranslate"><span class="pre">merge</span></code>). In particular, <strong>shuffling</strong> operations that rearrange data can become very communication intensive.</p>
</section>
<section id="pandas-performance-tips">
<h3>pandas performance tips<a class="headerlink" href="#pandas-performance-tips" title="Permalink to this heading">#</a></h3>
<p>pandas performance tips such as using vectorized operations also apply to Dask DataFrames. See <a class="reference external" href="https://github.com/TomAugspurger/effective-pandas/blob/master/modern_1_intro.ipynb">Modern Pandas notebook</a> for more tips on better performance with pandas.</p>
</section>
<section id="check-partition-size">
<h3>Check Partition Size<a class="headerlink" href="#check-partition-size" title="Permalink to this heading">#</a></h3>
<p>Similar to chunks, partitions should be small enough that they fit in the memory, but large enough to avoid that the communication overhead.</p>
<section id="blocksize">
<h4><code class="docutils literal notranslate"><span class="pre">blocksize</span></code><a class="headerlink" href="#blocksize" title="Permalink to this heading">#</a></h4>
<ul class="simple">
<li><p>The number of partitions can be set using the <code class="docutils literal notranslate"><span class="pre">blocksize</span></code> argument.
If none is given, the number of partitions/blocksize is calculated depending on the available memory and the number of cores on a machine up to a max of 64 MB. As we increase the blocksize, the number of partitions (calculated by Dask) will decrease. This is especially important when reading one large csv file.</p></li>
</ul>
<p><strong>As a good rule of thumb, you should aim for partitions that have around 100MB of data each.</strong></p>
</section>
</section>
<section id="smart-use-of-compute">
<h3>Smart use of <code class="docutils literal notranslate"><span class="pre">.compute()</span></code><a class="headerlink" href="#smart-use-of-compute" title="Permalink to this heading">#</a></h3>
<p>Try avoiding running <code class="docutils literal notranslate"><span class="pre">.compute()</span></code> operation as long as possible. Dask works best when users avoid computation until results are needed. The <code class="docutils literal notranslate"><span class="pre">.compute()</span></code> command informs Dask to trigger computations on the Dask DataFrame.<br />
As shown in the above example, the intermediate results can also be shared by calling <code class="docutils literal notranslate"><span class="pre">.compute()</span></code> only once.</p>
</section>
<section id="close-your-local-dask-cluster">
<h3>Close your local Dask Cluster<a class="headerlink" href="#close-your-local-dask-cluster" title="Permalink to this heading">#</a></h3>
<p>It is always a good practice to close the Dask cluster you created.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this heading">#</a></h2>
<p>In this notebook, we have learned about:</p>
<ul class="simple">
<li><p>Dask DataFrame concept and component.</p></li>
<li><p>When to use and when to avoid Dask DataFrames?</p></li>
<li><p>How to use Dask DataFrame?</p></li>
<li><p>Some best practices around Dask DataFrames.</p></li>
</ul>
</section>
<section id="resources-and-references">
<h2>Resources and references<a class="headerlink" href="#resources-and-references" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Reference</p>
<ul>
<li><p><a class="reference external" href="https://dask.org/">Dask Docs</a></p></li>
<li><p><a class="reference external" href="https://examples.dask.org/">Dask Examples</a></p></li>
<li><p><a class="reference external" href="https://github.com/dask/dask/">Dask Code</a></p></li>
<li><p><a class="reference external" href="https://blog.dask.org/">Dask Blog</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/">Pandas Docs</a></p></li>
</ul>
</li>
<li><p>Ask for help</p>
<ul>
<li><p><a class="reference external" href="http://stackoverflow.com/questions/tagged/dask"><code class="docutils literal notranslate"><span class="pre">dask</span></code></a> tag on Stack Overflow, for usage questions</p></li>
<li><p><a class="reference external" href="https://github.com/dask/dask/discussions">github discussions: dask</a> for general, non-bug, discussion, and usage questions</p></li>
<li><p><a class="reference external" href="https://github.com/dask/dask/issues/new">github issues: dask</a> for bug reports and feature requests</p></li>
</ul>
</li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "npl-conda"
        },
        kernelOptions: {
            name: "npl-conda",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'npl-conda'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="01-dask-array.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Dask Arrays</p>
      </div>
    </a>
    <a class="right-next"
       href="03-dask-xarray.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Parallelizing Xarray with Dask</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#in-this-tutorial-you-learn">In this tutorial, you learn:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#related-documentation">Related Documentation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-dask-dataframe">What is Dask DataFrame?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#when-to-use-dask-dataframe-and-when-to-avoid-it">When to use Dask DataFrame and when to avoid it?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tutorial-dataset">Tutorial Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#download-the-data">Download the data</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-dataframe-basics">Pandas DataFrame Basics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operations-on-pandas-dataframe">Operations on pandas DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-analysis">Simple Analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling-up-to-a-larger-dataset">Scaling up to a larger dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computations-on-dask-dataframe">Computations on Dask DataFrame</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-localcluster-client-with-dask">Create a “LocalCluster” Client with Dask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dask-dataframe-read-csv-to-read-multiple-files">Dask DataFrame <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> to read multiple files</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lazy-evaluation">Lazy Evaluation</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#nice-but-what-did-dask-do">Nice, but what did Dask do?</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-compute-wisely">Use <code class="docutils literal notranslate"><span class="pre">.compute</span></code> wisely!</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#share-intermediate-results">Share intermediate results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#persist-or-caching"><code class="docutils literal notranslate"><span class="pre">.persist</span></code> or caching</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dask-dataframes-best-practices">Dask DataFrames Best Practices</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-pandas-when-you-can">Use pandas (when you can)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#avoid-full-data-shuffling">Avoid Full-Data Shuffling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pandas-performance-tips">pandas performance tips</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-partition-size">Check Partition Size</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#blocksize"><code class="docutils literal notranslate"><span class="pre">blocksize</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smart-use-of-compute">Smart use of <code class="docutils literal notranslate"><span class="pre">.compute()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#close-your-local-dask-cluster">Close your local Dask Cluster</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Negin Sobhani, Brian Vanderwende, Deepak Cherian, Ben Kirk
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>